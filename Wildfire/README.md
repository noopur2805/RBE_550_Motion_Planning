# Motion_Planning_for_Firefighting_Truck

## About the Project

The goal of this project is to implement a motion planning algorithm for a firetruck that must plan paths to the most important fire to fight, as fires spread, and new fires get started. This project is implemented using the pygame library of python. The environment for the same is simulated as a two dimensional grid world.

## About the environment

The environment consists of a flat square field, 250 meters on a side, filled with obstacles. The obstacles consist of large patches of un-navigable thick brush, trees, and weeds, suspiciously shaped like giant tetrominoes. While the environment is not specifically a grid, the base dimension for each obstacle square unit is 15 meters. Inside this field, a firetruck operates, attempting to extinguish fires that emerge.

Starting at time 0 and at 10 second intervals, a major conflagration is set at a random obstacle. This sets the obstacle state to burning. This obstacle sets all obstacles withing 30 meter radius to the state of burning.

The truck starts at a random point in the map. If the truck stops within 10 meters of a burning obstacle, it sets the state to extinguished.

A snapshot of the firetruck extinguishing fire is shown below:
![environment_snapshot](https://user-images.githubusercontent.com/53962958/143947392-92a7f519-8fe3-4bd5-a786-12e28d75e4c6.png)


## Planners used:
The above problem statement is implemented using two different planners and their results are compared. The following planners were used:
### Combinatorial Planner (A-Star) :
The combinatorial planner consists of A-Star Algorithm with some additional penalties for reverse. The effect of the penalty is quite visible in the simulation as the truck avoids travel in reverse direction and takes a longer circular route to reach the goal point. Since the environment is simulated in a grid world using pygame, the entire simulation is pixelated, as evident in the video, due to which the truck fails to maintain its rectangular shape most of the times.

Following is an example of the simulation using A-Star Planner:
```
python main.py
```

https://user-images.githubusercontent.com/53962958/143948497-4f5667bd-a4e2-485b-9c10-6945fe68509c.mp4

### Sampling based Planner (Probabilistic Roadmap):
The sampling based planner consists of constructing a Probabilistic Roadmap. A total of 100 nodes were randomly selected for constructing the Roadmap. The Configruation Space was initially divided into free space and obstacle space. The nodes were sampled in free space, and the edges were generated by determining the collision free paths. To identify the edges, the nearest neighbour approach using the kd-tree is implemented in python. The feasibile path for the global planner is calculated using the A-Star Algotithm without non-holonomic constraints. Then a fast local planner is implemented between the nodes identified by the global planner. For this project, A-Star algorithm with non-holonomic constraints is implemented. With some modifications, an aritificial potential field can also be implemented for the local planner instead of the A-Star planner.

An example of a probabilistic Road Map is shown below:

![PRM_Example](https://user-images.githubusercontent.com/53962958/143950647-5fe07dc9-0f29-44d4-a542-0dd24e66ab5d.png)


Following is an example of the simulation using Probabilistic Road Map:
```
python main.py
```

https://user-images.githubusercontent.com/53962958/143950085-2afc62e5-55dd-438b-9580-85d4a2f32f34.mp4

## Results of Comparison of both planners

The extinguished to burned ratio indicates how fast a planner responds to a burning world. As seen in the figure below, the ratio is higher for the PRM Planner than the A-Star Planner, indicating a better suitability for this scenario.

![e_b](https://user-images.githubusercontent.com/53962958/143950804-0f6c90cb-9920-46c2-a4e6-4925bc93ffb3.png)

Here is a graph on the computational time required for running a 3 minute simulation. As per the data below, the computational resource utilized by the PRM Planner is consistent whereas the A-Star graph seems to vary. However, on running more tests, it was found out that the A-Star Planner consistently used lower resources than the Probabilistic Road Map Planner.

![time](https://user-images.githubusercontent.com/53962958/143950861-5805692a-e244-4002-99be-f2d719258a9c.png)

# References

* Steven M. LaValle. Planning Algorithms. Cambridge University Press, May 2006.
9780521862059. URL http://lavalle.pl/planning/.
* https://canvas.wpi.edu
* https://demonstrations.wolfram.com/ProbabilisticRoadmapMethod/

